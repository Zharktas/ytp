---

# Forced maintenance leave is removed in future. Ontology import requires CKAN web API.
- name: Leave maintenance mode
  file: path="/var/www/maintenance" state=absent
  tags:
  - maintenance

- name: Import dataset tags
  shell: "{{ virtual_environment }}/bin/paster --plugin=ckanext-ytp-tasks ytp-task-add -c {{ ckan_ini }} --execute import_dataset_tags ckanext.ytp.dataset.tags_import manual '{\"topic_url\": \"http://dev.finto.fi/rest/v1/avoindata-topic/data\", \"contenttype_url\": \"http://dev.finto.fi/rest/v1/avoindata-ct/data\", \"data_format\": \"n3\", \"meta_name\": \"z_avoindatafi_metadata\"}'"
  tags:
  - data
  - data-tags-celery

- name: Import organization types
  shell: "{{ virtual_environment }}/bin/paster --plugin=ckanext-ytp-tasks ytp-task-add -c {{ ckan_ini }} --execute import_organization_types ckanext.ytp.organizations.organization_type_import manual '{\"data_url\": \"http://api.finto.fi/rest/v1/jupo/data\",\"data_format\": \"n3\"}'"
  tags:
  - data
  - data-organization-types

- name: Import base organizations
  shell: "{{ virtual_environment }}/bin/paster --plugin=ckanext-ytp-tasks ytp-task-add -c {{ ckan_ini }} --execute import_base_organizations ckanext.ytp.organizations.organization_import manual '{\"url\": \"https://raw2.github.com/yhteentoimivuuspalvelut/ytp-tools/master/organization.json\"}'"
  tags:
  - data

- include: harvest.yml
