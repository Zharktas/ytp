<!-- ckanext/ytp/dataset/templates/package/snippets/ytp_additional_info.html -->
<section class="dataset-additional-info">
  <h3>{{ _('Extra information') }}</h3>

  {% block package_additional_info %}
    <dl class="dl-horizontal">
    {% set extra_dict = h.format_extras(pkg_dict) %}

    {% if extra_dict.author_email %}
      <dt>{{ _("Author") }}</dt>
      <dd>{{ h.mail_to(email_address=extra_dict.author_email, name=extra_dict.author) }}</dd>
    {% elif extra_dict.author %}
      <dt>{{ _("Author") }}</dt>
      <dd>{{ extra_dict.author }}</dd>
    {% endif %}

    {% if extra_dict.maintainer_email %}
      <dt>{{ _("Maintainer") }}</dt>
      <dd>{{ h.mail_to(email_address=extra_dict.maintainer_email, name=extra_dict.maintainer) }}</dd>
    {% elif extra_dict.maintainer %}
      <dt>{{ _("Maintainer") }}</dt>
      <dd>{{ extra_dict.maintainer }}</dd>
    {% endif %}

    {% if extra_dict.owner %}
      <dt>{{ _("Owner") }}</dt>
      <dd>{{ extra_dict.owner }}</dd>
    {% endif %}

    {% if extra_dict.license_url or dict.license_title  %}
      <dt>{{ _("License") }}</dt>
      <dd>{% if extra_dict.license_url %}
        <a href ="{{ extra_dict.license_url }}">
        {% if extra_dict.license_title %}
            {{ extra_dict.license_title }}
        {% else %}
            {{ extra_dict.license_url }}
        {% endif %}
        </a>
        {% else %}
            {{extra_dict.license_title}}
        {% endif %}
        </dd>
    {% endif %}

    {% if extra_dict.copyright_notice %}
      <dt>{{ _("Copyright Notice") }}</dt>
      <dd>{{ h.extra_translation(extra_dict, 'copyright_notice', markdown=True) }}</dd>
    {# TODO: This is for a specific harvest source and should be mapped during harvesting to the copyright field instead of handling it specifically in the template #}
    {% elif extra_dict.access_constraints %}
      {% set copyright_notice = h.get_json_value(h.get_pkg_dict_extra(pkg_dict, 'access_constraints', None)) %}
      <dt>{{ _("Copyright Notice") }}</dt>
      <dd>
          {%- if copyright_notice and copyright_notice.append -%}
            {% for item in copyright_notice %}
              <p>{{ item }}</p>
            {% endfor %}
          {%- else -%}
            {{ copyright_notice }}
          {%- endif -%}
       </dd>
    {% endif %}

    {% if extra_dict.warranty_disclaimer %}
      <dt>{{ _("Disclaimer of Warranty") }}</dt>
      <dd>{{ h.extra_translation(extra_dict, 'warranty_disclaimer', markdown=True) }}</dd>
    {% endif %}

    {% set websites = extra_dict.extra_information %}
    {% if websites|count > 0 %}
        <dt>{{ _('Extra information') }}</dt>
        {% for site in websites %}
            <dd>{{ site|urlize }}</dd>
        {% endfor %}
    {% endif %}
    </dl>

    {% set extra_dict = h.clean_extras(extra_dict) %}
    <button type="button"  class="btn btn-danger" data-toggle="collapse" data-target="#extra_extra">
        {{_('Technical extra information')}}
    </button>
    <dl id="extra_extra" class="collapse dl-horizontal">
    {% for key  in extra_dict.keys() %}
        <dt>{{ _(key) }}</dt>
        <dd>{{ extra_dict.get(key) }}</dd>
    {% endfor %}
    </dl>

  {% endblock %}

</section>
