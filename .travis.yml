language: python
python:
- "2.7"
branches:
  only:
  - master
  - ci-testing
notifications:
  flowdock: 4c5e3d825b1a21302c14ae60aaf9e36c
cache:
  directories:
  - /usr/lib/ckan/default/src/
  - $HOME/cache
  apt: true
env:
  global:
  - secure: dDrOLI+aYjtdYVtS/JE++czaSyQVR3Ab9dnYlHWE9e87nHlgG701VnqgRsNKIFpDFsfp0rRCY1zMYwxY088JwaIQeFpSiz2Vr61tTF9Xv6dsEHAAnDohAq1YtGcbLfXur26/eW603Lxb2rl943gTd21Z9MucICR93eaIULgGoYE=
  - secure: IbPq0ZCEh0e5bkfD855zzi1BmUb6vAcgsyyFDJQn5pkQVZJ/aE+661f3UQx9L8PfzsJlwEo5MMbPGseUm8A7LeX6sEaQjOCSopev57xxk2DceH07e+0QjudwL43bu1GA7qWL+72uIF38+0U+sfZlM/peUbbvLdamWw0tQyHpuWY=
  - secure: T5w1iO++xJ0h2LsR6kuZ7Jn3/CmtIyo6/KS/C4jptdQanScCbwslf5GmDVwqiRGweqT4yOpKm5+80Rg7ruT+qNa6C6dxnSifInrCghN79h1CPLz65uRik/5j/oLtxuL3yX4AZLX/ETN1VEvYZpl3ItaygW6yj1UfdbCzIXfTaSU=
before_install:
- git submodule update --init --recursive
install:
- pip install flake8 --download-cache=$HOME/cache
- sudo apt-get -qy install sshpass
script:
- ./scripts/test.sh
- flake8 --max-line-length=120 .
after_success:
- sshpass -e scp script/install.sh "$USERNAME@$SSHHOST:/home/$USERNAME/"
